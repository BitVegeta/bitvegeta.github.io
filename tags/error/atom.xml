<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: Error | 精神和时间的小屋]]></title>
  <link href="http://bitvegeta.github.io/tags/error/atom.xml" rel="self"/>
  <link href="http://bitvegeta.github.io/"/>
  <updated>2015-04-15T22:03:07+08:00</updated>
  <id>http://bitvegeta.github.io/</id>
  <author>
    <name><![CDATA[Bitegeta]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Octopress Error and Solution in Github Pages Building]]></title>
    <link href="http://bitvegeta.github.io/blog/octopress-error-and-solution-for-github-pages/"/>
    <updated>2015-04-15T14:24:38+08:00</updated>
    <id>http://bitvegeta.github.io/blog/octopress-error-and-solution-for-github-pages</id>
    <content type="html"><![CDATA[<p>在完善美化 Octopress Github Pages 博客过程中，又遇到不少问题，原因各种各样，有的至今不明所以，现把操作步骤，问题及解决方法一并记录到这里，供搜索参考，或深入研究。有不对之处，还望高手斧正！</p>

<h3 id="categories">侧边栏添加－分类目录 Categories</h3>

<p>网上已经有很详细明白的教程，这里的内容参考原文链接见[1]。</p>

<p><strong>增加category_list插件</strong></p>

<p>保存以下代码到 <code>plugins/category_list_tag.rb</code> ：</p>

<p>&#8220;`
module Jekyll
  class CategoryListTag &lt; Liquid::Tag
    def render(context)
      html = “”
      categories = context.registers[:site].categories.keys
      categories.sort.each do |category|
        posts_in_category = context.registers[:site].categories[category].size
        category_dir = context.registers[:site].config[‘category_dir’]
        category_url = File.join(category_dir, category.gsub(/_|\P{Word}/, ‘-‘).gsub(/-{2,}/, ‘-‘).downcase)
        html « “&lt;li class=&#8217;category&#8217;&gt;<a href="http://bitvegeta.github.io/#{category_url}/">#{category} (#{posts_in_category})</a>&lt;/li&gt;\n”
      end
      html
    end
  end
end</p>

<p>Liquid::Template.register_tag(‘category_list’, Jekyll::CategoryListTag)
&#8220;`</p>

<p>这个插件会向 liquid 注册一个名为 category_list 的 tag，该 tag 就是以 li 的形式将站点所有的 category 组织起来。如果要将 category 加入到侧边导航栏，需要增加一个 aside。</p>

<p><strong>增加aside</strong></p>

<p>复制以下代码到 <code>source/_includes/asides/category_list.html</code>。</p>

<p>&#8220;`</p>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    {% category_list %}
  </ul>
</section>
<p>&#8220;`
配置侧边栏需要修改 _config.yml 文件，修改其 default_asides 项：</p>

<p><code>
default_asides: [asides/category_list.html, asides/recent_posts.html]
</code>
以上 asides 可根据自己的需求调整，比如进行一些汉化的工作。</p>

<p><strong>问题</strong></p>

<p>在测试文档里添加 category 重新生成页面后，我遇到了一个问题：<strong>categories 的显示首字母不是大写的</strong>;几经搜索，终于解决了这个问题，参考方案来源在［2］里；</p>

<p>过程如下，在 <code>/plugins/category_list_tag.rb</code>文件里在 <code>#{category}</code>里添加“.capitalize”参数，或者直接用下面代码全面替换源代码即可；</p>

<p>&#8220;`
module Jekyll
  class CategoryListTag &lt; Liquid::Tag
    def render(context)
      html = “”
      categories = context.registers[:site].categories.keys
      categories.sort.each do |category|
        posts_in_category = context.registers[:site].categories[category].size
        category_dir = context.registers[:site].config[‘category_dir’]
        category_url = File.join(category_dir, category.gsub(/_|\P{Word}/, ‘-‘).gsub(/-{2,}/, ‘-‘).downcase)
        html « “&lt;li class=&#8217;category&#8217;&gt;<a href="http://bitvegeta.github.io/blog/categories/#{category.to_url.downcase}/">#{category.capitalize} (#{posts_in_category})</a>&lt;/li&gt;\n”
      end
      html
    end
  end
end</p>

<p>Liquid::Template.register_tag(‘category_list’, Jekyll::CategoryListTag)
&#8220;`
### 侧边栏添加－标签云 Tags</p>

<p>标签云的解决方案最常见的是一个 NB 程序员叫 robbyedwards 写的插件。这里的内容参考原文链接见[3]。</p>

<p><strong>首先</strong>，到 robbyedwards 的 Github 个人主页 clone 两个项目。</p>

<ul>
  <li>
    <p>用来生成 tag 页面： <code>https://github.com/robbyedwards/octopress-tag-pages</code>；</p>
  </li>
  <li>
    <p>用来生成 tag 云：<code>https://github.com/robbyedwards/octopress-tag-cloud</code></p>
  </li>
</ul>

<p><strong>octopress-tag-pages</strong></p>

<ul>
  <li>复制 <code>tag_generator.rb</code> 到 <code>/plugins</code> 目录；</li>
  <li>复制 <code>tag_index.html</code> 到 <code>/source/_layouts</code> 目录；</li>
  <li>复制 <code>tag_feed.xml</code> 到 <code>/source/_includes/custom/</code> 目录。</li>
</ul>

<p><strong>octopress-tag-cloud</strong></p>

<ul>
  <li>复制 <code>tag_cloud.rb</code> 到 <code>/plugins</code> 目录；</li>
  <li>
    <p>复制以下代码到 <code>/source/_includes/custom/asides/tags.html</code>。</p>

    <p>&#8220;`</p>
  </li>
</ul>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
    {% tag_cloud font-size: 90-210%, limit: 10, style: para %}
  </ul>
</section>
<p>&#8220;`
其中的 tag_cloud 参数，<code>style :para</code>指定不使用li来分割，<code>limit</code>限定10个tag，<code>font-size</code> 指定tag的大小范围，具体参数参看官方文档。</p>

<ul>
  <li>
    <p>最后，在 _config.xml 的 default_asides 中添加这个 tag cloud ，如下：</p>

    <p><code>
 default_asides: [asides/category_list.html, asides/recent_posts.html, custom/asides/tags.html]
</code></p>
  </li>
</ul>

<p>上面步骤完成，在测试文档中添加 tag ，如下：</p>

<h2 id="section">&#8220;`</h2>
<p>layout: post
title: “test”
date: 2015-04-15 13:23:35 +0800
comments: true
categories: Octopress
tags: tt ss</p>

<hr />
<p>&#8220;`</p>

<p>然后在终端 <code>rake gen_deploy</code> 生成新页面，我遇到了两个错误：</p>

<p><strong>错误一</strong></p>

<p><code>
Liquid Exception: comparison of Array with Array failed in _layouts/page.html
jekyll 2.5.2 | Error:  comparison of Array with Array failed
</code>
- 解决办法：去掉 tag_cloud 里面的 <code>limit:</code>参数即可；</p>

<p><strong>错误二</strong></p>

<p><code>
Build Warning: Layout 'nil' requested in tags/tt/atom.xml does not exist.
Build Warning: Layout 'nil' requested in tags/ss/atom.xml does not exist.
</code>
- 解决办法：检查并确保下列的文件其头部信息里同样为 <code>layout: null</code>;</p>

<pre><code>- 首先，检查刚才复制的 `/source/_layouts／tag_index.html` 文件;
- `source/atom.xml`
- `source/robots.txt`
- `source/_includes/custom/category_feed.xml`
</code></pre>

<h3 id="section-1">参考资料</h3>

<ul>
  <li>
    <p>[1]<a href="http://codemacro.com/2012/07/18/add-category-list-to-octopress/">为octopress添加分类(category)列表</a>
[1]:http://codemacro.com/2012/07/18/add-category-list-to-octopress/</p>
  </li>
  <li>
    <p>[2]<a href="http://myweb.jowai.info/jekyll-graphic-from-hello-world-to-a-fully-functioning-personal-site/">图解Jekyll：从Hello World到功能完善的个人站点</a>
[2]:http://myweb.jowai.info/jekyll-graphic-from-hello-world-to-a-fully-functioning-personal-site/</p>
  </li>
  <li>
    <p>[3]<a href="http://codemacro.com/2012/07/18/add-tag-to-octopress/">为octopress添加tag cloud</a>
[3]:http://codemacro.com/2012/07/18/add-tag-to-octopress/</p>
  </li>
</ul>
]]></content>
  </entry>
  
</feed>
